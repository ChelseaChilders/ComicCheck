<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js">
</script> 

<script>
    var allIssues = [];
    
    (function() {
        "use strict";
        
        var main = function() {
            var url;
            
            var j=0;
            while(j<=70){
                url = 'Issues_files/Issues'+j+'.json';
                my100rows(url,j);
                j++;
            }
            
            console.log(allIssues);
        };
        
        $(document).ready(main);
        
    }());
    
    var my100rows = function(url,j){
        $.getJSON(url, function(results) {
                
                var i = 0;
                
                var IssueID;
                var IssueNameResponse;
                var IssueDescResponse;
                var IssueDateResponse;
                var IssueNumResponse;
                var IssueImgResponse;
                var IssueBriefDescResponse;
                
                var IssueResponse;

                if(j == 209){
                    while(i<100){
                        IssueID = results.results[i].id;
                        IssueNameResponse = results.results[i].name;
                        IssueDescResponse = results.results[i].description;
                        IssueDateResponse = results.results[i].cover_date;
                        IssueNumResponse = results.results[i].issue_number;
                        IssueImgResponse = results.results[i].image.icon_url;
                        IssueBriefDescResponse = results.results[i].deck;
                
                        IssueResponse = [IssueID, '"'+IssueNameResponse+'"', IssueDescResponse, IssueDateResponse, IssueNumResponse, IssueImgResponse, IssueBriefDescResponse];
                
                        allIssues.push(IssueResponse);
                        i++;
                    }
                }else{
                    while(i<100){
                        IssueID = results.results[i].id;
                        IssueNameResponse = results.results[i].name;
                        IssueDescResponse = results.results[i].description;
                        IssueDateResponse = results.results[i].cover_date;
                        if(IssueDateResponse == null){
                            IssueDateResponse = '0000-00-00';
                        }
                        IssueNumResponse = results.results[i].issue_number;
                        IssueImgResponse = results.results[i].image.icon_url;
                        
                        //var mynum = 1964-01-01.toString();
                        IssueResponse = [IssueID, '"'+IssueNameResponse+'"',IssueNumResponse,'"'+IssueImgResponse+'"',''+IssueDescResponse+''];
                
                        allIssues.push(IssueResponse);
                        i++;
                    }
                }
            
            });
    }
    
    function download_csv() {
        var csv = 'ID,Name,Desc,Date,IssueNum,Img,BreifDesc\n';
        allIssues.forEach(function(row) {
            csv += row.join(',');
            csv += "\n";
        });
        var hiddenElement = document.createElement('a');
        hiddenElement.href = 'data:text/csv;charset=utf-8,' + encodeURI(csv);
        hiddenElement.target = '_blank';
        hiddenElement.download = 'Issue.csv';
        hiddenElement.click();
    }
    
</script>

<button onclick="download_csv()">Download CSV</button>

